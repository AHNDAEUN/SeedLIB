<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.seed.lib.member.MemberMapper">

		<insert id="setJoin" parameterType="MemberVO">
		INSERT INTO MEMBER (USERNAME, PASSWORD, NAME, EMAIL, BIRTH, PHONE, POST, ADDRESS1, ADDRESS2, ENABLED, LOANSTATUS, OVMYRCOUNT, DROPSTATUS)
		VALUES ( #{userName}, #{password}, #{name}, #{email}, #{birth}, #{phone}, #{post}, #{address1}, #{address2}, 0, 0, 0, 0)
		</insert> 

			  <select id="getLogin" parameterType="MemberVO" resultMap="getLoginResult">
			
				SELECT M.*, R.*
					FROM MEMBER M
					  INNER JOIN
					  MEMBER_ROLE MR
					  ON M.USERNAME = MR.USERNAME
					  INNER JOIN
					  ROLE R 
					  ON MR.ROLENUM =R.ROLENUM
					  WHERE M.USERNAME= #{userName}
					  
			</select>
					  
		<resultMap type="MemberVO" id="getLoginResult">
		<id column="username" property="userName" />
		<id column="password" property="password" />
		<result column="name" property="name"/>
		<result column="birth" property="birth"/>
		<result column="email" property="email"/>
		<result column="phone" property="phone"/>
		<result column="post" property="post"/>
		<result column="address1" property="address1"/>
		<result column="address2" property="address2"/>
		<result column="enabled" property="enabled"/>
		<result column="loanstatus" property="loanStatus"/>
		<result column="ovmyrcount" property="ovMyrCount"/>
		<result column="dropstatus" property="dropStatus"/>
		<collection property="roleVOs" javaType="List" ofType="RoleVO">
			<result column="roleName" property="roleName"/>
		</collection>
		</resultMap>
		
		
		
		
		
</mapper>    